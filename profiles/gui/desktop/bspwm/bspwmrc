# xrandr --auto &

# HACK: This is a hack to get the monitors to get apps to see the displays
export DISPLAY=:0


# TODO: upgrade this logic to couple logic with device rather than hostname
# lshw, dmidecode and hostname
myhostname=$(hostname)

# Check the hostname
if [ "$myhostname" == "kita" ]; then
    bspc monitor DP-1 -d terminal
    bspc monitor HDMI-2 -d browser
elif [ "$myhostname" == "fiji" ]; then
    # HACK
    ~/layout.sh
    bspc monitor eDP-1 -d terminal
    bspc monitor eDP-2 -d browser
fi

# Various settings
bspc config gapless_monocle       true
bspc config borderless_monocle    true
bspc config single_monocle        true

bspc config split_ratio           0.52
bspc config focus_follows_pointer true

bspc config active_border_color '#000000'
bspc config normal_border_color '#000000'
bspc config focused_border_color '#222222'


export GAP=50;
export PADDING=20;
bspc config top_padding "$((0))"
bspc config bottom_padding "$((0))"
bspc config left_padding "$((0))"
bspc config right_padding "$((0))"
bspc config window_gap "${GAP}"

bspc desktop -l monocle
# BUG: PATH should be available in bspwmrc
pgrep --full --list-name better-monocle-mode || ${HOME}/.local/bin/better-monocle-mode &
pgrep --full --list-name terminal-desktop-bspwm || ${HOME}/.local/bin/terminal-desktop-bspwm &

# BUG: This will be too large on non-HIDPI displays
# bspc rule -a 'floating-term' state=floating follow=on focus=on rectangle=${2000:-1000}x${2000:-1000}+0+0 center=true

# bspc rule -a mpv state=floating

# Ensure shadows are only on floating windows
# bspc subscribe node_state | while read -r _ _ _ node state status; do
#   if [[ "$state" == "floating" ]]; then
#     case "$status" in
#       off) xprop -id "$node" -remove _COMPTON_SHADOW;;
#       on) xprop -id "$node" -f _COMPTON_SHADOW 32c -set _COMPTON_SHADOW 1;;
#     esac
#   fi
# done &

# Blank screen after 5 minutes
# xset s 300 300
